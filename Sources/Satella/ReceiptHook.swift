import SatellaC
import StoreKit
import Orion

// Generate a fake receipt to help crack IAPs on iOS 12 and 13. Very rarely works on 14 and 15.

class ReceiptHook: ClassHook<SKPaymentTransaction> {
	typealias Group = Receipt
	
	func transactionReceipt() -> Data? {
		let now       = Int64(Date().timeIntervalSince1970) * 1000
		let bvrs      = Bundle.main.object(forInfoDictionaryKey: "CFBundleShortVersionString") as? String
		let receiptId = Int.random(in: 1...999999)
		let vendorId  = UIDevice.current.identifierForVendor?.uuidString
		let bundleId  = Bundle.main.bundleIdentifier
		let uniqueId  = Int.random(in: 1...999999)
		
		if bvrs == nil || vendorId == nil || bundleId == nil {
			let fullReceiptStatic = "ewoJInNpZ25hdHVyZSIgPSAiQTBMN0Z4UE9lUDBJUGFnd0UrQ3V4bTFNcFZmOE1qVHRvKzdGRGJUTkE5SHhPU1ZVK1h6UVFrcHVxd1RJQzlzZEpMQ2F2S3d6UGpmWUkvOGZXRWJSZldiVFBHUHpIZFZNdHU1clhaOE9JSnNRKy9ySGtMR1lPT3czdmpjdmo3Vk1uRlZOQ2VhRmpjKy9VeWRQVzJxbUlxOHJnUm8rNS9IZGZZTFhTWi8yd1NlcXhlRlR4WVJqRDh0ckdrMjlqajlEcGppNzBjNlFxQlFHaE9nRXB3RzlhSmJJdWFHdnA5OXE1RDlWQjlUSVpVM2FIU3BNa2kwNUdqNkZBellOMG8xQmRkV3VQR3l3d1crdHJBamhyWlhlQVJKc1NwN0xTTzFLRWVjbzNBYk5Od012dE5KL2pLd3AvMlN1UllIL21tdE95ZDF1bzRxUUJQVVhoSXdVUnBtZ0dDUUFBQVdBTUlJRmZEQ0NCR1NnQXdJQkFnSUlEdXRYaCtlZUNZMHdEUVlKS29aSWh2Y05BUUVGQlFBd2daWXhDekFKQmdOVkJBWVRBbFZUTVJNd0VRWURWUVFLREFwQmNIQnNaU0JKYm1NdU1Td3dLZ1lEVlFRTERDTkJjSEJzWlNCWGIzSnNaSGRwWkdVZ1JHVjJaV3h2Y0dWeUlGSmxiR0YwYVc5dWN6RkVNRUlHQTFVRUF3dzdRWEJ3YkdVZ1YyOXliR1IzYVdSbElFUmxkbVZzYjNCbGNpQlNaV3hoZEdsdmJuTWdRMlZ5ZEdsbWFXTmhkR2x2YmlCQmRYUm9iM0pwZEhrd0hoY05NVFV4TVRFek1ESXhOVEE1V2hjTk1qTXdNakEzTWpFME9EUTNXakNCaVRFM01EVUdBMVVFQXd3dVRXRmpJRUZ3Y0NCVGRHOXlaU0JoYm1RZ2FWUjFibVZ6SUZOMGIzSmxJRkpsWTJWcGNIUWdVMmxuYm1sdVp6RXNNQ29HQTFVRUN3d2pRWEJ3YkdVZ1YyOXliR1IzYVdSbElFUmxkbVZzYjNCbGNpQlNaV3hoZEdsdmJuTXhFekFSQmdOVkJBb01Da0Z3Y0d4bElFbHVZeTR4Q3pBSkJnTlZCQVlUQWxWVE1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBcGMrQi9TV2lnVnZXaCswajJqTWNqdUlqd0tYRUpzczl4cC9zU2cxVmh2K2tBdGVYeWpsVWJYMS9zbFFZbmNRc1VuR09aSHVDem9tNlNkWUk1YlNJY2M4L1cwWXV4c1FkdUFPcFdLSUVQaUY0MWR1MzBJNFNqWU5NV3lwb041UEM4cjBleE5LaERFcFlVcXNTNCszZEg1Z1ZrRFV0d3N3U3lvMUlnZmRZZUZScjZJd3hOaDlLQmd4SFZQTTNrTGl5a29sOVg2U0ZTdUhBbk9DNnBMdUNsMlAwSzVQQi9UNXZ5c0gxUEttUFVockFKUXAyRHQ3K21mNy93bXYxVzE2c2MxRkpDRmFKekVPUXpJNkJBdENnbDdaY3NhRnBhWWVRRUdnbUpqbTRIUkJ6c0FwZHhYUFEzM1k3MkMzWmlCN2o3QWZQNG83UTAvb21WWUh2NGdOSkl3SURBUUFCbzRJQjF6Q0NBZE13UHdZSUt3WUJCUVVIQVFFRU16QXhNQzhHQ0NzR0FRVUZCekFCaGlOb2RIUndPaTh2YjJOemNDNWhjSEJzWlM1amIyMHZiMk56Y0RBekxYZDNaSEl3TkRBZEJnTlZIUTRFRmdRVWthU2MvTVIydDUrZ2l2Uk45WTgyWGUwckJJVXdEQVlEVlIwVEFRSC9CQUl3QURBZkJnTlZIU01FR0RBV2dCU0lKeGNKcWJZWVlJdnM2N3IyUjFuRlVsU2p0ekNDQVI0R0ExVWRJQVNDQVJVd2dnRVJNSUlCRFFZS0tvWklodmRqWkFVR0FUQ0IvakNCd3dZSUt3WUJCUVVIQWdJd2diWU1nYk5TWld4cFlXNWpaU0J2YmlCMGFHbHpJR05sY25ScFptbGpZWFJsSUdKNUlHRnVlU0J3WVhKMGVTQmhjM04xYldWeklHRmpZMlZ3ZEdGdVkyVWdiMllnZEdobElIUm9aVzRnWVhCd2JHbGpZV0pzWlNCemRHRnVaR0Z5WkNCMFpYSnRjeUJoYm1RZ1kyOXVaR2wwYVc5dWN5QnZaaUIxYzJVc0lHTmxjblJwWm1sallYUmxJSEJ2YkdsamVTQmhibVFnWTJWeWRHbG1hV05oZEdsdmJpQndjbUZqZEdsalpTQnpkR0YwWlcxbGJuUnpMakEyQmdnckJnRUZCUWNDQVJZcWFIUjBjRG92TDNkM2R5NWhjSEJzWlM1amIyMHZZMlZ5ZEdsbWFXTmhkR1ZoZFhSb2IzSnBkSGt2TUE0R0ExVWREd0VCL3dRRUF3SUhnREFRQmdvcWhraUc5Mk5rQmdzQkJBSUZBREFOQmdrcWhraUc5dzBCQVFVRkFBT0NBUUVBRGFZYjB5NDk0MXNyQjI1Q2xtelQ2SXhETUlKZjRGelJqYjY5RDcwYS9DV1MyNHlGdzRCWjMrUGkxeTRGRkt3TjI3YTQvdncxTG56THJSZHJqbjhmNUhlNXNXZVZ0Qk5lcGhtR2R2aGFJSlhuWTR3UGMvem83Y1lmcnBuNFpVaGNvT0FvT3NBUU55MjVvQVE1SDNPNXlBWDk4dDUvR2lvcWJpc0IvS0FnWE5ucmZTZW1NL2oxbU9DK1JOdXhUR2Y4YmdwUHllSUdxTktYODZlT2ExR2lXb1IxWmRFV0JHTGp3Vi8xQ0tuUGFObVNBTW5CakxQNGpRQmt1bGhnd0h5dmozWEthYmxiS3RZZGFHNllRdlZNcHpjWm04dzdISG9aUS9PamJiOUlZQVlNTnBJcjdONFl0UkhhTFNQUWp2eWdhWndYRzU2QWV6bEhSVEJoTDhjVHFBPT0iOwoJInB1cmNoYXNlLWluZm8iID0gImV3b0pJbk5wWjI1aGRIVnlaU0lnUFNBaVFUQk1OMFo0VUU5bFVEQkpVR0ZuZDBVclEzVjRiVEZOY0ZabU9FMXFWSFJ2S3pkR1JHSlVUa0U1U0hoUFUxWlZLMWg2VVZGcmNIVnhkMVJKUXpselpFcE1RMkYyUzNkNlVHcG1XVWt2T0daWFJXSlNabGRpVkZCSFVIcElaRlpOZEhVMWNsaGFPRTlKU25OUkt5OXlTR3RNUjFsUFQzY3pkbXBqZG1vM1ZrMXVSbFpPUTJWaFJtcGpLeTlWZVdSUVZ6SnhiVWx4T0hKblVtOHJOUzlJWkdaWlRGaFRXaTh5ZDFObGNYaGxSbFI0V1ZKcVJEaDBja2RyTWpscWFqbEVjR3BwTnpCak5sRnhRbEZIYUU5blJYQjNSemxoU21KSmRXRkhkbkE1T1hFMVJEbFdRamxVU1ZwVk0yRklVM0JOYTJrd05VZHFOa1pCZWxsT01HOHhRbVJrVjNWUVIzbDNkMWNyZEhKQmFtaHlXbGhsUVZKS2MxTndOMHhUVHpGTFJXVmpiek5CWWs1T2QwMTJkRTVLTDJwTGQzQXZNbE4xVWxsSUwyMXRkRTk1WkRGMWJ6UnhVVUpRVlZob1NYZFZVbkJ0WjBkRFVVRkJRVmRCVFVsSlJtWkVRME5DUjFOblFYZEpRa0ZuU1VsRWRYUllhQ3RsWlVOWk1IZEVVVmxLUzI5YVNXaDJZMDVCVVVWR1FsRkJkMmRhV1hoRGVrRktRbWRPVmtKQldWUkJiRlpVVFZKTmQwVlJXVVJXVVZGTFJFRndRbU5JUW5OYVUwSktZbTFOZFUxVGQzZExaMWxFVmxGUlRFUkRUa0pqU0VKeldsTkNXR0l6U25OYVNHUndXa2RWWjFKSFZqSmFWM2gyWTBkV2VVbEdTbXhpUjBZd1lWYzVkV042UmtWTlJVbEhRVEZWUlVGM2R6ZFJXRUozWWtkVloxWXlPWGxpUjFJellWZFNiRWxGVW14a2JWWnpZak5DYkdOcFFsTmFWM2hvWkVkc2RtSnVUV2RSTWxaNVpFZHNiV0ZYVG1oa1IyeDJZbWxDUW1SWVVtOWlNMHB3WkVocmQwaG9ZMDVOVkZWNFRWUkZlazFFU1hoT1ZFRTFWMmhqVGsxcVRYZE5ha0V6VFdwRk1FOUVVVE5YYWtOQ2FWUkZNMDFFVlVkQk1WVkZRWGQzZFZSWFJtcEpSVVozWTBOQ1ZHUkhPWGxhVTBKb1ltMVJaMkZXVWpGaWJWWjZTVVpPTUdJelNteEpSa3BzV1RKV2NHTklVV2RWTW14dVltMXNkVnA2UlhOTlEyOUhRVEZWUlVOM2QycFJXRUozWWtkVloxWXlPWGxpUjFJellWZFNiRWxGVW14a2JWWnpZak5DYkdOcFFsTmFWM2hvWkVkc2RtSnVUWGhGZWtGU1FtZE9Wa0pCYjAxRGEwWjNZMGQ0YkVsRmJIVlplVFI0UTNwQlNrSm5UbFpDUVZsVVFXeFdWRTFKU1VKSmFrRk9RbWRyY1docmFVYzVkekJDUVZGRlJrRkJUME5CVVRoQlRVbEpRa05uUzBOQlVVVkJjR01yUWk5VFYybG5WblpYYUNzd2FqSnFUV05xZFVscWQwdFlSVXB6Y3psNGNDOXpVMmN4Vm1oMksydEJkR1ZZZVdwc1ZXSllNUzl6YkZGWmJtTlJjMVZ1UjA5YVNIVkRlbTl0TmxOa1dVazFZbE5KWTJNNEwxY3dXWFY0YzFGa2RVRlBjRmRMU1VWUWFVWTBNV1IxTXpCSk5GTnFXVTVOVjNsd2IwNDFVRU00Y2pCbGVFNUxhRVJGY0ZsVmNYTlROQ3N6WkVnMVoxWnJSRlYwZDNOM1UzbHZNVWxuWm1SWlpVWlNjalpKZDNoT2FEbExRbWQ0U0ZaUVRUTnJUR2w1YTI5c09WZzJVMFpUZFVoQmJrOURObkJNZFVOc01sQXdTelZRUWk5VU5YWjVjMGd4VUV0dFVGVm9ja0ZLVVhBeVJIUTNLMjFtTnk5M2JYWXhWekUyYzJNeFJrcERSbUZLZWtWUFVYcEpOa0pCZEVObmJEZGFZM05oUm5CaFdXVlJSVWRuYlVwcWJUUklVa0o2YzBGd1pIaFlVRkV6TTFrM01rTXpXbWxDTjJvM1FXWlFORzgzVVRBdmIyMVdXVWgyTkdkT1NrbDNTVVJCVVVGQ2J6UkpRakY2UTBOQlpFMTNVSGRaU1V0M1dVSkNVVlZJUVZGRlJVMTZRWGhOUXpoSFEwTnpSMEZSVlVaQ2VrRkNhR2xPYjJSSVVuZFBhVGgyWWpKT2VtTkROV2hqU0VKeldsTTFhbUl5TUhaaU1rNTZZMFJCZWt4WVpETmFTRWwzVGtSQlpFSm5UbFpJVVRSRlJtZFJWV3RoVTJNdlRWSXlkRFVyWjJsMlVrNDVXVGd5V0dVd2NrSkpWWGRFUVZsRVZsSXdWRUZSU0M5Q1FVbDNRVVJCWmtKblRsWklVMDFGUjBSQlYyZENVMGxLZUdOS2NXSlpXVmxKZG5NMk4zSXlVakZ1UmxWc1UycDBla05EUVZJMFIwRXhWV1JKUVZORFFWSlZkMmRuUlZKTlNVbENSRkZaUzB0dldrbG9kbVJxV2tGVlIwRlVRMEl2YWtOQ2QzZFpTVXQzV1VKQ1VWVklRV2RKZDJkaVdVMW5ZazVUV2xkNGNGbFhOV3BhVTBKMlltbENNR0ZIYkhwSlIwNXNZMjVTY0ZwdGJHcFpXRkpzU1VkS05VbEhSblZsVTBKM1dWaEtNR1ZUUW1oak0wNHhZbGRXZWtsSFJtcFpNbFozWkVkR2RWa3lWV2RpTWxsblpFZG9iRWxJVW05YVZ6Um5XVmhDZDJKSGJHcFpWMHB6V2xOQ2VtUkhSblZhUjBaNVdrTkNNRnBZU25SamVVSm9ZbTFSWjFreU9YVmFSMnd3WVZjNWRXTjVRblphYVVJeFl6SlZjMGxIVG14amJsSndXbTFzYWxsWVVteEpTRUoyWWtkc2FtVlRRbWhpYlZGbldUSldlV1JIYkcxaFYwNW9aRWRzZG1KcFFuZGpiVVpxWkVkc2FscFRRbnBrUjBZd1dsY3hiR0p1VW5wTWFrRXlRbWRuY2tKblJVWkNVV05EUVZKWmNXRklVakJqUkc5MlRETmtNMlI1TldoalNFSnpXbE0xYW1JeU1IWlpNbFo1WkVkc2JXRlhUbWhrUjFab1pGaFNiMkl6U25Ca1NHdDJUVUUwUjBFeFZXUkVkMFZDTDNkUlJVRjNTVWhuUkVGUlFtZHZjV2hyYVVjNU1rNXJRbWR6UWtKQlNVWkJSRUZPUW1kcmNXaHJhVWM1ZHpCQ1FWRlZSa0ZCVDBOQlVVVkJSR0ZaWWpCNU5EazBNWE55UWpJMVEyeHRlbFEyU1hoRVRVbEtaalJHZWxKcVlqWTVSRGN3WVM5RFYxTXlOSGxHZHpSQ1dqTXJVR2t4ZVRSR1JrdDNUakkzWVRRdmRuY3hURzU2VEhKU1pISnFiamhtTlVobE5YTlhaVlowUWs1bGNHaHRSMlIyYUdGSlNsaHVXVFIzVUdNdmVtODNZMWxtY25CdU5GcFZhR052VDBGdlQzTkJVVTU1TWpWdlFWRTFTRE5QTlhsQldEazRkRFV2UjJsdmNXSnBjMEl2UzBGbldFNXVjbVpUWlcxTkwyb3hiVTlESzFKT2RYaFVSMlk0WW1kd1VIbGxTVWR4VGt0WU9EWmxUMkV4UjJsWGIxSXhXbVJGVjBKSFRHcDNWaTh4UTB0dVVHRk9iVk5CVFc1Q2FreFFOR3BSUW10MWJHaG5kMGg1ZG1veldFdGhZbXhpUzNSWlpHRkhObGxSZGxaTmNIcGpXbTA0ZHpkSVNHOWFVUzlQYW1KaU9VbFpRVmxOVG5CSmNqZE9ORmwwVWtoaFRGTlFVV3AyZVdkaFduZFlSelUyUVdWNmJFaFNWRUpvVERoalZIRkJQVDBpT3dvSkluQjFjbU5vWVhObExXbHVabThpSUQwZ0ltVjNiMHBKYlRsNVlWZGtjR0p0Um5OTVdFSXhZMjFPYjFsWVRteE1WMUpvWkVkVmRHTklUakJKYVVFNVNVTkplVTFFU1hoTVZFRXpURlJGTVVsRVFUQlBha2sxVDJwQmQwbEZSblJhV0Vwd1dUSkZkbFJIT1hwWU1FWjFXakpXYzFwWVRXbFBkMjlLU1c1Q01XTnRUbTlaV0U1c1RGZFNhR1JIVlhSaVdFMXBTVVF3WjBscVJUQlBSRUY0VGtSVk5VMTZVWGxOYWxGcFQzZHZTa2x1Vm5WaFdFWXhXbE14Y0ZwSFZuVmtSMnh0WVZkV2VVbHBRVGxKUTBwWFRXMW9jMWt5TVZaYU1XeFpVMjE0U2xOR1NuWlhiRTVEWTIxS2RHSkVTbUZYUlRFeFUxVk5kMW94UlhsaFIyaHFZbFZXTVVscWMwdERVMHAyWTIxc2JtRlhOV2hpUXpFd1kyMUdkV015Um1wa1IyeDJZbWt4Y0ZwRFNXZFFVMEZwVGtSUmQwMUVRWGROYWxrelRWUkZNVTFFVVhoSmFuTkxRMU5LYVdSdVNucEphVUU1U1VOSmVVeHFWWFZOUTBrM1EyZHJhVmxZUW5kTVYyd3dXbGN3ZEdGWFVXbEpSREJuU1dwRmVFMUVXVFZOZWxrMVRXcEZhVTkzYjBwSmJsSjVXVmMxZWxsWFRqQmhWemwxVEZkc2EwbHBRVGxKUTBrd1RrUkJkMDFFUVhsT2FtTjRUVlJWZDA1RVJXbFBkMjlLU1c1R01WbFhOVEJoV0ZJMVNXbEJPVWxEU1hoSmFuTkxRMU5LZG1OdGJHNWhWelZvWWtNeGQyUllTbXBoUjBaNldsTXhhMWxZVW14TVZ6RjZTV2xCT1VsRFNYaE9SR2QzVFZSUk1VOVVUVEJOYWtrd1NXcHpTME5UU2pGaWJXeDRaRmRWZEdSdFZuVmFSemw1VEZkc2ExcFhOVEJoVjFwd1dsaEphVWxFTUdkSmExcEdVV3RSZVZFd1JURk1WVVYzVFdwSmRFNUZSa0pPUXpGRFQxVk9RMHhVU1RCUmVrSkZUMVZOZVUxRlVUTk9lVWszUTJkcmFXRllVbXhpVXpGd1drTkpaMUJUUVdsTlZFVjRUa1JCZUU1VVp6Qk5RMGszUTJkcmFXUnRWbmxqTW14Mllta3hiR1ZJVW14amJUVm9Za014Y0ZwSFZuVmtSMnh0WVZkV2VVbHBRVGxKUTBsM1RucEZNVTFVUlhsUFUwazNRMmRyYVdOSVNuWmFTRlpxWkVNeGNGcERTV2RRVTBGcFdWZHJkV05IUm5Cak0wNXNZakkwZFdNeVJqQmFWM2h6V1ZNMWFtVllRak5pYVVrM1EyZHJhV05JVm5sWk1taG9ZekpWZEZwSFJqQmFVMGxuVUZOQmFVMXFRWGxOVXpCM1Rua3dlRTVUUVhoTlZHOTVUMVJ2ZDAxRFFrWmtSMDEyVWpBeFZVbHFjMHREVTBwMlkyMXNibUZYTldoaVF6RjNaRmhLYW1GSFJucGFVekZyV1ZoU2JFbHBRVGxKUTBsNVRVUkplRXhVUVROTVZFVXhTVVJGZUU5cVNUVlBha0YzU1VWV01GbDVPVWhVVmxGcFQzZHZTa2x0U25CYVEwbG5VRk5CYVZsWGEzVmpSMFp3WXpOT2JHSXlOSFZqTWtZd1dsZDRjMWxUU1RkRFoydHBZMGhXZVZreWFHaGpNbFYwV2tkR01GcFRNWGRqTTFGcFNVUXdaMGxxU1hkTmFrVjBUVVJqZEUxVVZXZE5SRkUyVFdwck5rMUVRV2RSVnpGc1kyMXNhbGxUT1UxaU0wNW1VVmMxYmxwWGVHeGplVWszUTI0d1BTSTdDZ2tpY0c5a0lpQTlJQ0kwTkNJN0Nna2ljMmxuYm1sdVp5MXpkR0YwZFhNaUlEMGdJakFpT3dwOSI7CgkicG9kIiA9ICI0NCI7Cgkic2lnbmluZy1zdGF0dXMiID0gIjAiOwp9"
			
			guard let finalReceiptStatic = fullReceiptStatic.data(using: .utf8) else {
				return nil
			}
			
			return finalReceiptStatic
		}
		
		let purchaseInfo = "{\n\t\"original-purchase-date-pst\" = \"\(Date()) America/Los_Angeles\";\n\t\"purchase-date-ms\" = \"\(now)\";\n\t\"unique-identifier\" = \"satella-uid-\(uniqueId)\";\n\t\"original-transaction-id\" = \"satella-tId-\(receiptId)\";\n\t\"bvrs\" = \"\(String(describing: bvrs))\";\n\t\"app-item-id\" = \"\(receiptId)\";\n\t\"transaction-id\" = \"\(receiptId)\";\n\t\"quantity\" = \"1\";\n\t\"original-purchase-date-ms\" = \"\(now)\";\n\t\"unique-vendor-identifier\" = \"\(String(describing: vendorId))\";\n\t\"item-id\" = \"\(receiptId)\";\n\t\"version-external-identifier\" = \"07151129\";\n\t\"product-id\" = \"\(String(describing: target.payment.productIdentifier))\";\n\t\"purchase-date\" = \"\(Date()) Etc/GMT\";\n\t\"original-purchase-date\" = \"\(Date()) Etc/GMT\";\n\t\"bid\" = \"\(String(describing: bundleId))\";\n\t\"purchase-date-pst\" = \"\(Date()) America/Los_Angeles\";\n}"
		
		let purchaseData         = purchaseInfo.data(using: .utf8)
		var purchaseB64: String? = nil
		
		if let purchaseData = purchaseData {
			purchaseB64 = String(data: purchaseData, encoding: .utf8)
		}
		
		let fullReceipt = "{\n\t\"signature\" = \"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\";\n\t\"purchase-info\" = \"\(String(describing: purchaseB64))\";\n\t\"pod\" = \"44\";\n\t\"signing-status\" = \"0\";\n}"
		
		guard let finalReceipt = fullReceipt.data(using: .utf8) else {
			return nil
		}
		
		return finalReceipt
	}
}